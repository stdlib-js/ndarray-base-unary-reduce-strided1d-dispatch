// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-property@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-ndarray-like@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-empty-collection@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function-array@v0.2.2-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-data-type@v0.2.1-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-output-data-type-policy@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-reduce-strided1d@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-output-dtype@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype-resolve-enum@v0.2.2-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-spread-dimensions@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-shape@v0.2.2-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ndims@v0.2.2-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype@v0.2.2-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-order@v0.2.2-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-empty@v0.3.0-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-indices-complement@esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed@v0.2.2-esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zero-to@v0.2.1-esm/index.mjs";import _ from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-copy@v0.2.2-esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-every-by@v0.2.2-esm/index.mjs";import k from"https://cdn.jsdelivr.net/gh/stdlib-js/object-assign@v0.2.2-esm/index.mjs";import F from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import{isPrimitive as D}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.2.2-esm/index.mjs";import{primitives as O}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@v0.2.2-esm/index.mjs";import S from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";var z={dims:null,keepdims:!1};function q(e,t,s,r){var i;if(!V(r))return new TypeError(F("null2V",r));if(A(r,"keepdims")&&(e.keepdims=r.keepdims,!D(e.keepdims)))return new TypeError(F("null2o","keepdims",e.keepdims));if(A(r,"dims")){if(e.dims=r.dims,!O(e.dims)&&!d(e.dims))return new TypeError(F("invalid option. `%s` option must be an array of integers. Option: `%s`.","dims",e.dims));if(null===(i=S(e.dims,t-1)))return new RangeError(F("invalid option. `%s` option contains an out-of-bounds dimension index. Option: [%s].","dims",_(e.dims,",")));if(i.length!==e.dims.length)return new Error(F("invalid option. `%s` option contains duplicate indices. Option: [%s].","dims",_(e.dims,",")));e.dims=i}return A(r,"dtype")&&(e.dtype=r.dtype,!p(s,e.dtype))?new TypeError(F("null4S","dtype",_(s,'", "'),e.dtype)):null}function L(e,t,s,r,i,n,d,a,o){var m,p,l,h;for(m=n,l=0;l<e;l++){for(p=o,h=0;h<t&&s[m+h*i]===d[p];h++)p+=a;if(h===t)return l;m+=r}return-1}function R(e){var t,s;for(t=[],s=0;s<e.length;s++)t.push(u(e[s]));return t}function B(e,t){var s,r,i;for(s=[],r=0,i=0;r<=e.length;r++)1===r?s.push(t):(s.push(e[i]),i+=1);return s}function C(e,s,p,l){var h,u;if(!(this instanceof C))return new C(e,s,p,l);if(!r(e))throw new TypeError(F("null3L",e));if(!i(e.default))throw new TypeError(F('invalid argument. First argument must be an object having a "default" property and an associated method.'));if(t(e,"types")&&!n(e.types)&&!d(e.types))throw new TypeError(F('invalid argument. First argument must be an object having a "types" property whose associated value is an array-like object.'));if(t(e,"fcns")&&!a(e.fcns)&&!d(e.fcns))throw new TypeError(F('invalid argument. First argument must be an object having a "fcns" property whose associated value is an array-like object containing functions.'));if(!n(s))throw new TypeError(F("null2y",s));for(u=0;u<s.length;u++)if(h=s[u],!n(h)||h.length<1||!T(h,o))throw new TypeError(F("invalid argument. Second argument must contain arrays of data types. Value: `%s`.",s));if(!n(p)||p.length<1||!T(p,o))throw new TypeError(F("invalid argument. Third argument must be an array of data types. Value: `%s`.",p));if(!m(l))throw new TypeError(F("invalid argument. Fourth argument must be a supported output data type policy. Value: `%s`.",l));if(this._table={default:e.default,types:e.types?R(e.types):[],fcns:e.fcns?E(e.fcns):[]},this._table.types.length!==this._table.fcns.length)throw new Error("invalid argument. First argument specifies an unexpected number of types. An input ndarray data type must be specified for each provided strided reduction function.");return this._idtypes=s,this._odtypes=p,this._policy=l,this}e(C.prototype,"apply",(function(e){var t,r,i,n,d,a,o,m,j,E,T,V,A,D,O;if(i=arguments.length,!s(e))throw new TypeError(F("null5t",e));if(T=c(e),!p(this._idtypes[0],T))throw new TypeError(F('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',_(this._idtypes[0],'", "'),T));for(n=[e],O=1;O<i&&s(E=arguments[O]);O++){if(T=c(E),!p(this._idtypes[O],T))throw new TypeError(F('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',O,_(this._idtypes[O],'", "'),T));n.push(E)}if(O<i-1)throw new TypeError(F("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",O,arguments[O]));if(A=(m=f(e)).length,d=k({},z),i>O&&(t=arguments[i-1],a=q(d,A,this._odtypes,t)))throw a;return null===d.dims&&(d.dims=x(A)),o=b(A,d.dims),j=w(m,o),D=g(j,{dtype:d.dtype||h(T,this._policy),order:v(e)}),r=[u(T)],V=(O=L(this._table.fcns.length,1,this._table.types,1,1,0,r,1,0))>=0?this._table.fcns[O]:this._table.default,l(V,B(n,D),d.dims),d.keepdims&&(D=y(A,D,o)),D})),e(C.prototype,"assign",(function(e){var t,r,i,n,d,a,o,m,h,y,f,v,g;if(i=arguments.length,!s(e))throw new TypeError(F("null5t",e));if(h=c(e),!p(this._idtypes[0],h))throw new TypeError(F('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',_(this._idtypes[0],'", "'),h));for(d=[e],g=1;g<i&&s(a=arguments[g]);g++)d.push(a);if(g<2)throw new TypeError(F("invalid argument. Second argument must be an ndarray-like object. Value: `%s`.",arguments[1]));if(g===i-1)t=arguments[g],m=!0;else if(g<i-1)throw new TypeError(F("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",g,arguments[g]));for(v=d.pop(),g=1;g<d.length;g++)if(h=c(d[g]),!p(this._idtypes[g],h))throw new TypeError(F('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',g,_(this._idtypes[g],'", "'),h));if(y=j(e),n=k({},z),m&&(o=q(n,y,this._odtypes,t)))throw o;return null===n.dims&&(n.dims=x(y)),r=[u(h)],f=(g=L(this._table.fcns.length,1,this._table.types,1,1,0,r,1,0))>=0?this._table.fcns[g]:this._table.default,l(f,B(d,v),n.dims),v}));export{C as default};
//# sourceMappingURL=index.mjs.map
