// Copyright (c) 2025 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.2.1-esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-ndarray-like@v0.2.2-esm/index.mjs";import s from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-object@v0.2.2-esm/index.mjs";import r from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.2.2-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.2.2-esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-is-data-type@v0.2.1-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-output-data-type-policy@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-assert-contains@v0.2.2-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-reduce-strided1d@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-unary-output-dtype@v0.2.2-esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-spread-dimensions@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-shape@v0.2.2-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-ndims@v0.2.2-esm/index.mjs";import y from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-dtype@v0.2.2-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-order@v0.2.2-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-empty@v0.3.0-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-indices-complement@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-take-indexed@v0.2.2-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-zero-to@v0.2.1-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-join@v0.1.1-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/array-base-every-by@v0.2.2-esm/index.mjs";import w from"https://cdn.jsdelivr.net/gh/stdlib-js/object-assign@v0.2.2-esm/index.mjs";import x from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.2.2-esm/index.mjs";import E from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.2.2-esm/index.mjs";import T from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.2.2-esm/index.mjs";import{isPrimitive as _}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.2.2-esm/index.mjs";import{primitives as k}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@v0.2.2-esm/index.mjs";import V from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-empty-collection@v0.2.2-esm/index.mjs";import A from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-to-unique-normalized-indices@esm/index.mjs";var D={dims:null,keepdims:!1};function F(e,t,s,r){var i;if(!E(r))return new TypeError(x("null2V",r));if(T(r,"keepdims")&&(e.keepdims=r.keepdims,!_(e.keepdims)))return new TypeError(x("null2o","keepdims",e.keepdims));if(T(r,"dims")){if(e.dims=r.dims,!k(e.dims)&&!V(e.dims))return new TypeError(x("invalid option. `%s` option must be an array of integers. Option: `%s`.","dims",e.dims));if(null===(i=A(e.dims,t-1)))return new RangeError(x("invalid option. `%s` option contains an out-of-bounds dimension index. Option: [%s].","dims",b(e.dims,",")));if(i.length!==e.dims.length)return new Error(x("invalid option. `%s` option contains duplicate indices. Option: [%s].","dims",b(e.dims,",")));e.dims=i}return T(r,"dtype")&&(e.dtype=r.dtype,!o(s,e.dtype))?new TypeError(x("null4S","dtype",b(s,'", "'),e.dtype)):null}function O(e,t,o,a){var m,p;if(!(this instanceof O))return new O(e,t,o,a);if(!s(e))throw new TypeError(x("null3L",e));if(!r(e.default))throw new TypeError(x('invalid argument. First argument must be an object having a "default" property and an associated method.'));if(!i(t))throw new TypeError(x("null2y",t));for(p=0;p<t.length;p++)if(m=t[p],!i(m)||m.length<1||!c(m,n))throw new TypeError(x("invalid argument. Second argument must contain arrays of data types. Value: `%s`.",t));if(!i(o)||o.length<1||!c(o,n))throw new TypeError(x("invalid argument. Third argument must be an array of data types. Value: `%s`.",o));if(!d(a))throw new TypeError(x("invalid argument. Fourth argument must be a supported output data type policy. Value: `%s`.",a));return this._table=e,this._idtypes=t,this._odtypes=o,this._policy=a,this}e(O.prototype,"apply",(function(e){var s,r,i,n,d,h,c,E,T,_,k,V,A,O;if(r=arguments.length,!t(e))throw new TypeError(x("null5t",e));if(_=y(e),!o(this._idtypes[0],_))throw new TypeError(x('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',b(this._idtypes[0],'", "'),_));for(i=[e],O=1;O<r&&t(T=arguments[O]);O++){if(_=y(T),!o(this._idtypes[O],_))throw new TypeError(x('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',O,b(this._idtypes[O],'", "'),_));i.push(T)}if(O<r-1)throw new TypeError(x("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",O,arguments[O]));if(V=(c=l(e)).length,n=w({},D),r>O&&(s=arguments[r-1],d=F(n,V,this._odtypes,s)))throw d;return null===n.dims&&(n.dims=g(V)),h=f(V,n.dims),E=v(c,h),A=u(E,{dtype:n.dtype||m(_,this._policy),order:j(e)}),k=this._table[_]||this._table.default,i.push(A),a(k,i,n.dims),n.keepdims&&(A=p(V,A,h)),A})),e(O.prototype,"assign",(function(e){var s,r,i,n,d,m,p,l,j,u,f,v;if(r=arguments.length,!t(e))throw new TypeError(x("null5t",e));if(j=y(e),!o(this._idtypes[0],j))throw new TypeError(x('invalid argument. First argument must have one of the following data types: "%s". Data type: `%s`.',b(this._idtypes[0],'", "'),j));for(n=[e],v=1;v<r&&t(d=arguments[v]);v++)n.push(d);if(v<2)throw new TypeError(x("invalid argument. Second argument must be an ndarray-like object. Value: `%s`.",arguments[1]));if(v===r-1)s=arguments[v],l=!0;else if(v<r-1)throw new TypeError(x("invalid argument. Argument %d must be an ndarray-like object. Value: `%s`.",v,arguments[v]));for(v=1;v<n.length-1;v++)if(j=y(n[v]),!o(this._idtypes[v],j))throw new TypeError(x('invalid argument. Argument %d must have one of the following data types: "%s". Data type: `%s`.',v,b(this._idtypes[v],'", "'),j));if(u=h(e),i=w({},D),l&&(m=F(i,u,this._odtypes,s)))throw m;return null===i.dims&&(i.dims=g(u)),f=this._table[j]||this._table.default,p=n[1],n[1]=n[n.length-1],n[n.length-1]=p,a(f,n,i.dims),n[1]}));export{O as default};
//# sourceMappingURL=index.mjs.map
